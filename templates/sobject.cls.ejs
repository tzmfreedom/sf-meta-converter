// generated by salesforce2js
public with sharing class <%= name %>ApiController {
    public <%= name %>ApiController() {}

    @RemoteAction
    public static Map<String, Object> query(String query) {
        return new Map<String, Object> {
            'success' => true,
            'records' => Database.query(query)
        };
    }

    @RemoteAction
    public static Map<String, Object> create(Map<String, Object> properties) {
        <%= name %> obj = new <%= name %>();
        <%- fields.map((f) => `obj.${f.name} = properties.get('${f.name}');`).join("\n        ") %>
        try {
            insert obj;
            return new Map<String, Object>{
                'success' => true,
                'id' => obj.Id
            };
        } catch (Exception e) {
            return new Map<String, Object> {
                'success' => false,
                'error' => e.getMessage()
            };
        }
    }

    @RemoteAction
    public static Map<String, Object> updateRecord(String sfid, Map<String, Object> properties) {
        <%= name %> obj = [SELECT Id FROM <%= name %> WHERE Id = :sfid];
        <%- fields.map((f) => `obj.${f.name} = properties.get('${f.name}');`).join("\n        ") %>
        try {
            update obj;
            return new Map<String, Object>{
                'success' => true,
                'id' => obj.Id
            };
        } catch (Exception e) {
            return new Map<String, Object> {
                'success' => false,
                'error' => e.getMessage()
            };
        }
    }

    @RemoteAction
    public static Map<String, Object> destroy(String sfid) {
        try {
            Database.DeleteResult dr = Database.delete(sfid);
            return new Map<String, Object> {
                'success' => dr.isSuccess()
            };
        } catch (Exception e) {
            return new Map<String, Object> {
                'success' => false,
                'error' => e.getMessage()
            };
        }
    }
}